{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ê²Œì„ì „ì </title>
    <link rel="stylesheet" href="{% static 'css/game.css' %}">
</head>
<body>
<header>
    <div>
        <h1 class="floating">âœï¸ ê²Œì„ ì „ì  ğŸ²</h1>
    </div>
    <nav id="main-nav">
        <a href="{% url 'games:main' %}" class="btn">í™ˆ</a>
        <a href="{% url 'games:game_attack' %}" class="btn">ê²Œì„ ì‹œì‘</a>
        <a href="{% url 'games:game_list' %}" class="btn">ê²Œì„ ì „ì </a>
        <a href="{% url 'games:game_rank' %}" class="btn">ë­í‚¹</a>
        <a href="{% url 'users:logout' %}" class="btn" onclick="GameApp.logout(); return false;">ë¡œê·¸ì•„ì›ƒ</a>
    </nav>
</header>

<main id="main-content" role="main">
    <h2>ğŸ“History ListğŸ“</h2>

    <div class="game-list-container">
        <div class="current-player">
            <h3>í˜„ì¬ í”Œë ˆì´ì–´: {{ user.username }}</h3>
        </div>

        <div class="game-history">
            <h3>ê²Œì„ ì „ì </h3>
            <table>
                <thead>
                <tr>
                    <th>ëŒ€ê²°</th>
                    <th>ìƒíƒœ</th>

                    <div>
                        <th>ê²Œì„ ì •ë³´</th>
                        <div id="game-info-content"></div>
                    </div>
                </tr>
                </thead>
                <tbody id="game-history-body">
                {% for attack in games_attack %}
                    {% if not attack.completed %}
                        <tr>
                            <th>{{ attack.attacker }} vs {{ attack.defender }}</th>
                            <th>ì§„í–‰ì¤‘!!
                                <form action="{% url 'games:game_delete' attack.pk %}" method="post"
                                      style="display:inline;">
                                    {% csrf_token %}
                                    <button type="submit">ì·¨ì†Œí•˜ê¸°</button>
                                </form>
                            </th>
                            <th><a href="{% url 'games:game_detail' attack.pk %}"> ê²Œì„ ì •ë³´</a></th>
                        </tr>
                    {% elif attack.completed %}
                        {% for results in result %}

                            {% if attack.id == results.game %}
                                {% if results.result %}
                                    <tr>
                                        <th>{{ attack.attacker }} vs {{ attack.defender }}</th>
                                        <th>ë¬´ìŠ¹ë¶€</th>
                                        <th><a href="{% url 'games:game_detail' attack.pk %}"> ê²Œì„ ì •ë³´</a></th>
                                    </tr>
                                {% elif attack.attacker == results.winner and attack.defender == results.loser %}

                                    <tr>
                                        <th>{{ attack.attacker }} vs {{ attack.defender }}</th>
                                        <th>ìŠ¹ë¦¬</th>
                                        <th><a href="{% url 'games:game_detail' attack.pk %}"> ê²Œì„ ì •ë³´</a></th>
                                    </tr>
                                {% elif attack.attacker == results.loser and attack.defender == results.winner %}

                                    <tr>
                                        <th>{{ attack.attacker }} vs {{ attack.defender }}</th>
                                        <th>íŒ¨ë°°</th>
                                        <th><a href="{% url 'games:game_detail' attack.pk %}"> ê²Œì„ ì •ë³´</a></th>
                                    </tr>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                {% endfor %}
                {% for defense in games_defense %}
                    {% if not defense.completed %}
                        <tr>
                            <th>{{ defense.attacker }} vs {{ defense.defender }}</th>
                            <th><a href="{% url 'games:game_defender' defense.pk %}"> ê²°íˆ¬ ì‹ ì²­í•˜ê¸°</a></th>
                            <th><a href="{% url 'games:game_detail' defense.pk %}"> ê²Œì„ ì •ë³´</a></th>
                        </tr>
                    {% elif defense.completed %}
                        {% for results in result %}

                            {% if defense.id == results.game %}
                                {% if results.result %}
                                    <tr>
                                        <th>{{ defense.attacker }} vs {{ defense.defender }}</th>
                                        <th>ë¬´ìŠ¹ë¶€</th>
                                        <th><a href="{% url 'games:game_detail' defense.pk %}"> ê²Œì„ ì •ë³´</a></th>
                                    </tr>
                                {% elif defense.attacker == results.winner and defense.defender == results.loser %}

                                    <tr>
                                        <th>{{ defense.attacker }} vs {{ defense.defender }}</th>
                                        <th>íŒ¨ë°°</th>
                                        <th><a href="{% url 'games:game_detail' defense.pk %}"> ê²Œì„ ì •ë³´</a></th>
                                    </tr>
                                {% elif defense.attacker == results.loser and defense.defender == results.winner %}

                                    <tr>
                                        <th>{{ defense.attacker }} vs {{ defense.defender }}</th>
                                        <th>ìŠ¹ë¦¬</th>
                                        <th><a href="{% url 'games:game_detail' defense.pk %}"> ê²Œì„ ì •ë³´</a></th>
                                    </tr>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</main>


<div class="fixed-footer-text">
    ğŸ€í”¼ë¡œê·¸ë˜ë° 21ê¸° ì¹´ë“œê²Œì„ 5ì¡°ğŸ€
</div>
</body>
</html>